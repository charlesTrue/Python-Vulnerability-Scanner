# ---------------------------------------------
# Programmer: Charles Trouilliere,(Cooper Nathan) ,(Ryan Larson)
# Project Python Vulnerability Scanner
# Date:T/TH Completed: 02/08/2024
# -------------------------------------------------------------
# Description: vulnerability scanner that automates the
# process of identifying known vulnerabilities in systems or
# websites. By integrating network scanning capabilities using
# Nmap and vulnerability assessment features using OpenVAS,
# the scanner aims to provide security professionals with a tool
# to efficiently assess and mitigate potential
# security risks within their networks.
# Command to run scanner script
# python vulnerability_scanner.py {TGT IP}/{Port#} --nmap --openvas
# ---------------------------------------------------------------/

import argparse
import subprocess

def nmap_scan(targets):
    print("Performing Nmap scan...")
    # Example: Run Nmap scan using subprocess
    nmap_command = ["nmap", "-sV", "-oX", "nmap_scan.xml"] + targets
    subprocess.run(nmap_command)

def openvas_scan(targets):
    print("Performing OpenVAS scan...")
    # Example: Run OpenVAS scan using subprocess
    openvas_command = ["openvas", "-o", "openvas_report.xml"] + targets
    subprocess.run(openvas_command)

# --------Main-----------------------------------------------------------------//
def main():
    parser = argparse.ArgumentParser(description="Python Vulnerability Scanner")
    parser.add_argument("targets", metavar="TARGET", nargs="+", help="Target IP addresses or ranges")
    parser.add_argument("--nmap", action="store_true", help="Perform Nmap scan")
    parser.add_argument("--openvas", action="store_true", help="Perform OpenVAS scan")
    args = parser.parse_args()

    if not args.nmap and not args.openvas:
        parser.error("Please specify at least one scan type (--nmap, --openvas)")

    if args.nmap:
        nmap_scan(args.targets)

    if args.openvas:
        openvas_scan(args.targets)

if __name__ == "__main__":
    main()


# Task 01: practice arithmetic expressions
# ---------------------------------------

# Command to run scanner script
# python vulnerability_scanner.py {TGT IP}/{Port#} --nmap --openvas
# ---------------------------------------